# TCP

### 三次握手

**A => B** `SYN seq = x`                                            *你愿意嫁给我吗？*

**B => A** `SYN seq = y  ack = x + 1`                 *我愿意，你愿意娶我吗？*

**A => B** `ack = y + 1`                                           *我愿意*



##### *两次握手可以吗？*

TCP是双向通信协议，通信双方都有能力发送消息，并接受响应，因为是可靠传输，所以需要双方都有一个确认。所以需要随机产生一个初始的序列号（seq）,并且把这个初始值告诉对方，等待对方确认。

通过对方传回的确认码（ack），发送方知道哪些数据包已经被对方收到了。



### 四次挥手

主动方：提分手的一方

被动方：被分手的一方

FIN仅代表主动方不会再发送报文了，但是可以接受报文



**A => B** `FIN seq = x ack = y`                             *我不爱你了*

**B => A** `ack = x + 1`                                             *我知道了，**我这还有你要的东西没给你***

**B => A** `FIN seq = w ack = x + 1`                     *这是你要的东西都给你，我也不爱你了*

**A => B** `ack = w + 1`                                              好的



##### *三次挥手可以吗？*

可以，当被动方正好没有数据给主动方时，将四次握手的第二步和第三步合并为一步

**A => B** `FIN seq = x ack = y`                             *我不爱你了*

**B => A** `FIN seq = w ack = x + 1`                     *我知道了，我没啥要说的，我也正好不爱你了*

**A => B** `ack = w + 1`                                              好的





