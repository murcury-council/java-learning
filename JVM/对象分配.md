# 对象分配

### 对象的创建

1.虚拟机遇到new指令时，首先检查这个指令的参数是否能在常量池（方法区）中定位到一个类的符号引用，并检查这个符号引用代表的类是否已经被加载、解析和初始化过，如果没有，则必须先执行响应的类加载过程。

2.为新生对象在堆中分配内存。对象所需大小在类加载完成后便可完全确定。

对象在队中分配内存式存在并发问题的。解决方案如下：

* CAS加失败重试
* TLAB，把内存分配的动作按照线程划分在不同的空间之中进行，重新分配TLAB的时候才需要同步锁定。是否使用TLAB通过-XX:+/-UseTLAB参数设定

3.将分配到的内存空间初始化为零值（不包括对象头）

4.对对象的对象头进行相关设置，如这个对象是哪个类的实例、如何才能找到类的元数据信息、对象的哈希码、对象的GC分代年龄等信息

### 对象的内存布局

对象头

实例数据

对齐填充